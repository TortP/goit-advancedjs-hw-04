{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '20370935-71350e4ff636eebefea7dcc17';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchImages = async (query, page = 1, perPage = 9) => {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n\n  return {\n    hits: response.data.hits,\n    totalHits: response.data.totalHits,\n  };\n};\n","export function createGalleryMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\" href=\"${largeImageURL}\">\n  <div class=\"image-wrapper\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" />\n  </div>\n  <div class=\"info\">\n              <p>Likes<br><strong>${likes}</strong></p>\n              <p>Views<br><strong>${views}</strong></p>\n              <p>Comments<br><strong>${comments}</strong></p>\n              <p>Downloads<br><strong>${downloads}</strong></p>\n            </div>\n          </div>\n        </li>\n      `\n    )\n    .join('');\n}\n","import './css/styles.css';\nimport '@fortawesome/fontawesome-free/css/all.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { createGalleryMarkup } from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loadCompleteText = document.querySelector('.load-complete');\n\nlet lightbox = new SimpleLightbox('.gallery li');\n\nlet currentPage = 1;\nconst perPage = 9;\nlet currentQuery = '';\nlet shownImageIds = new Set();\nlet totalImages = 0;\n\nfunction showToast(type, message) {\n  const options = {\n    message,\n    position: 'topRight',\n    timeout: 2000,\n    backgroundColor: '#ff4d4d',\n    titleColor: '#fff',\n    messageColor: '#fff',\n    icon: 'fa fa-times-circle',\n    iconColor: '#fff',\n    progressBarColor: '#fff',\n    close: true,\n    closeOnClick: true,\n  };\n  iziToast[type](options);\n}\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  currentQuery = form.elements.searchQuery.value.trim();\n  if (!currentQuery) {\n    showToast('warning', 'Enter a keyword to search!');\n    return;\n  }\n\n  currentPage = 1;\n  gallery.innerHTML = '';\n  shownImageIds.clear();\n  loadMoreBtn.classList.add('is-hidden');\n  loadCompleteText.classList.add('is-hidden');\n  loader.classList.add('is-hidden');\n\n  loader.classList.remove('is-hidden');\n\n  try {\n    const { hits, totalHits } = await fetchImages(\n      currentQuery,\n      currentPage,\n      perPage\n    );\n    totalImages = totalHits;\n\n    const newImages = hits.filter(img => !shownImageIds.has(img.id));\n    newImages.forEach(img => shownImageIds.add(img.id));\n\n    if (newImages.length === 0) {\n      showToast(\n        'error',\n        'Sorry, there are no images matching your search query. Please, try again!'\n      );\n    } else {\n      const markup = createGalleryMarkup(newImages);\n      gallery.insertAdjacentHTML('beforeend', markup);\n      lightbox.refresh();\n\n      if (shownImageIds.size < totalImages) {\n        loadMoreBtn.classList.remove('is-hidden');\n      } else {\n        loadCompleteText.classList.remove('is-hidden');\n      }\n    }\n  } catch (error) {\n    showToast('error', 'Something went wrong. Please try again later!');\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loader.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n  loadCompleteText.classList.add('is-hidden');\n\n  let newImages = [];\n  let tempPage = currentPage + 1;\n\n  try {\n    while (newImages.length < perPage) {\n      const { hits } = await fetchImages(currentQuery, tempPage, perPage);\n      const uniqueHits = hits.filter(img => !shownImageIds.has(img.id));\n\n      if (uniqueHits.length === 0) {\n        break;\n      }\n\n      uniqueHits.forEach(img => shownImageIds.add(img.id));\n      newImages.push(...uniqueHits);\n      tempPage += 1;\n\n      if (shownImageIds.size >= totalImages) {\n        break;\n      }\n    }\n\n    currentPage = tempPage - 1;\n\n    if (newImages.length > 0) {\n      const markup = createGalleryMarkup(newImages.slice(0, perPage));\n      gallery.insertAdjacentHTML('beforeend', markup);\n      lightbox.refresh();\n    }\n\n    if (shownImageIds.size >= totalImages || newImages.length < perPage) {\n      loadMoreBtn.classList.add('is-hidden');\n      loader.classList.add('is-hidden');\n      loadCompleteText.classList.remove('is-hidden');\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n      loader.classList.add('is-hidden');\n      loadCompleteText.classList.add('is-hidden');\n    }\n  } catch (error) {\n    showToast('error', 'Something went wrong. Please try again later!');\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","response","axios","createGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loader","loadMoreBtn","loadCompleteText","lightbox","SimpleLightbox","currentPage","currentQuery","shownImageIds","totalImages","showToast","type","message","options","iziToast","e","hits","totalHits","newImages","img","markup","tempPage","uniqueHits"],"mappings":"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"}